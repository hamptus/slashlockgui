#:set blue_back (133/255, 133/255, 232/255, 1)
#:import label kivy.uix.label
#:import sla kivy.adapters.simplelistadapter


<HorizontalContainer@RelativeLayout>
    size_hint: (1, None)
    height: 20

<ListItemLabel>
    color: (0, 0, 0, 1)
    halign: "left"
    text_size: self.size

    canvas.before:
        Color:
            rgba: (255/255, 255/255, 255/255, 1)
        Rectangle:
            size: self.size
            pos: self.pos

<PasswordInput@TextInput>
    multiline: False
    write_tab: False
    password: True
    color: (0, 0, 0, 1)
    height: self.minimum_height
    size_hint: (None, None)
    background_normal: self.background_active
    on_text_validate: app.set_passphrase()
    width: self.parent.width - 20
    pos: (10, 0)


<HorizontalSeparator@Widget>
    canvas:
        Color:
            rgba: (100/255, 100/255, 100/255, 0.2)
        Rectangle:
            size: (self.parent.width, 2)
            pos: self.pos

<LockButton@Button>
    background_normal: ""
    background_color: blue_back
    size: (100, 50)
    size_hint: (None, None)

<BlueBlackButton@Button>
    background_normal: ""
    background_color: blue_back
    size: (100, 50)
    size_hint: (None, None)

<EncryptScreen@Screen>
    name: "encrypt_screen"
    BoxLayout:
        id: encrypt_box_layout
        orientation: "vertical"
        Label:
            text: app.filename
            color: (0, 0, 0, 1)
        AnchorLayout:
            anchor_x: "center"
            anchor_y: "center"
            size: (self.parent.width, 50)
            size_hint: (1, 1)
            LockButton:
                text: "Lock"
                on_release: root.choose_directory()

<ChooseDirectoryScreen@Screen>
    name: "choose_directory_screen"
    BoxLayout:
        orientation: "vertical"
        size: root.size
        Label:
            text: "Where do you want to save your file?"
            color: (0, 0, 0, 1)
        AnchorLayout:
            anchor_x: "center"
            anchor_y: "top"
            size_hint: (1, 1)
            Label:
                id: save_directory_label
                text: "Save in: " + app.save_directory
                color: (0, 0, 0, 1)
                size_hint: None, None
                size: self.texture_size
        AnchorLayout:
            anchor_x: "center"
            anchor_y: "center"
            size: (self.parent.width, 50)
            BoxLayout:
                orientation: "horizontal"
                size_hint: None, None
                size: 270, 50
                spacing: 10

                BlueBlackButton:
                    text: "Choose a directory"
                    on_release: root.choose_directory()
                    size: (150, 50)

                BlueBlackButton:
                    text: "Continue"
                    on_release: root.click_continue()
                    size: (110, 50)

<FileNameScreen@Screen>
    name: "file_name_screen"
    BoxLayout:
        orientation: "vertical"
        size: root.size
        BoxLayout:
            orientation: "vertical"
            Label:
                text: "How would you like to name your file?"
                color: (0, 0, 0, 1)
            AnchorLayout:
                anchor_x: "center"
                anchor_y: "top"
                size_hint: (1, 1)
                TextInput:
                    focuse: True
                    multiline: False
                    text: app.save_as
                    color: (0, 0, 0, 1)
                    height: self.minimum_height
                    width: root.width - 8
                    size_hint: (None, None)
                    background_normal: self.background_active
                    on_text: app.save_as = self.text
        AnchorLayout:
            anchor_x: "center"
            anchor_y: "center"
            size: (self.parent.width, 50)
            size_hint: (1, 1)
            BlueBlackButton:
                text: "Randomize Name"
                size: (125, 50)
                on_release: app.randomize_name()
        AnchorLayout:
            anchor_x: "center"
            anchor_y: "center"
            size: (self.parent.width, 50)
            size_hint: (1, 1)
            BlueBlackButton:
                text: app.lock_or_unlock
                on_release: app.run_lock_or_unlock()

<SetPassphraseScreen@Screen>
    name: "set_passphrase_screen"
    passphrase: passphrase.__self__

    BoxLayout:
        orientation: "vertical"
        size: root.size
        StackLayout:
            HorizontalContainer:
                Label:
                    text: "Password:"
                    size_hint: None, None
                    text_size: self.width, None
                    height: self.texture_size[1]
                    color: (0, 0, 0, 1)
                    pos: (10, 0)
            HorizontalContainer:
                height: passphrase.height
                PasswordInput:
                    id: passphrase
                    focuse: True


            HorizontalContainer:
                Label:
                    text: "Confirm password:"
                    size_hint_y: None
                    text_size: self.width, None
                    height: self.texture_size[1] + 5
                    color: (0, 0, 0, 1)
                    pos: (10, 0)
            HorizontalContainer:
                height: confirm_passphrase.height
                PasswordInput:
                    id: confirm_passphrase

            HorizontalContainer:
                height: password_continue_button.height + 5
                BlueBlackButton:
                    id: password_continue_button
                    text: "Continue"
                    on_release: app.set_passphrase()
                    size: (120, 50)
                    pos: (10, 0)

<DropScreen@Screen>
    name: "drop_screen"

    BoxLayout:
        orientation: "vertical"
        id: encrypt_layout

        Label:
            text: "Drag a file here to lock or unlock it."
            color: blue_back
            font_size: 16

<ProcessingScreen@Screen>
    name: "processing_screen"

    AnchorLayout:
        id: processing_layout
        anchor_x: "center"
        anchor_y: "top"
        size_hint: (1, 1)
        padding: 20, 10

        Label:
            size_hint: (1, None)
            text: app.processing_status
            color: blue_back
            font_size: 16
            text_size: self.width, None
            height: self.texture_size[1]
            halign: 'left'

<ResultScreen@Screen>
    name: "result_screen"

    BoxLayout:
        orientation: "vertical"
        padding: 20, 10
        Label:
            text: app.result_message
            color: blue_back
            font_size: 16
            size_hint: (1, None)
            text_size: self.width, None
            height: self.texture_size[1]
            halign: 'left'
        AnchorLayout:
            anchor_x: "center"
            anchor_y: "center"
            size_hint: (1, 1)
            BlueBlackButton:
                text: "Start over"
                on_release: app._reset()

<AppContainer@BoxLayout>
    orientation: "vertical"

    canvas:
        Color:
            rgba: (255/255, 255/255, 255/255, 1)
        Rectangle:
            size: self.size
            pos: self.pos

    ActionBar:
        ActionView:
            use_separator: True
            background_color: blue_back
            background_image: ""
            ActionPrevious:
                title: "Slashlock"
                with_previous: False

    ScreenManager:
        id: screen_manager

        SetPassphraseScreen:
            id: set_passphrase_screen
        DropScreen:
            id: drop_screen
        EncryptScreen:
        ChooseDirectoryScreen:
        FileNameScreen:
        ProcessingScreen:
        ResultScreen:

AppContainer:
